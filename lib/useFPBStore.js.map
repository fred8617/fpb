{"version":3,"file":"useFPBStore.js","names":["emptyLayouts","xxl","xl","lg","md","sm","xs","Mode","breakpointsStandard","defaultbreakpoints","defaultCols","useFPBStore","props","force","useForceUpdate","store","useLocalStore","source","rowHeight","margin","layouts","breakpoints","cols","draggableCancelClassName","shortid","generate","draggableCancel","editingItem","isPreview","editingTitle","i","config","toJS","datas","breakpointsArr","recurseEverything","mode","DESIGN","isDesign","PRIVIEW","changeMode","e","target","value","breakpoint","defaultFormField","breakpointsConfig","Object","keys","computedLayout","fromEntries","map","point","hasLayout","length","setDatas","entries","key","data","Component","componentId","flatComponents","setLayouts","_currentLayout","JSON","stringify","setBreakpoint","_col","setBreakpointFromEntry","breakpointDiff","setBreakpointConfig","values","setBreakpointSettingVisible","deleteItem","remove","jsConfig","onBreakpointChange","onLayoutChange","onResize","onResizeStop","operatedItem","setOperatedItem","_layout","_oldItem","newItem","findItem","find","b","findItemInAllBreakpoints","items","item","getItemHeight","h","caclHeight","height","itemData","breakpointsItems","autoHeight","forEach","maxH","minH","undefined","Math","ceil","createItem","componentProps","isFormField","$id","set","onItemTypeChange","label","component","formField","onItemPropsChange","field","isEditing","setEditingItem","dealChildren","arr","components","parent","id","children","componentGroup","componentsHasGroup","filter","group","componentsNoGroup","allGroup","Set","returnGroup","filterGroup","push","breakpointSettingVisible"],"sources":["../src/fpb/useFPBStore.tsx"],"sourcesContent":["import React, { ExoticComponent } from 'react';\nimport { useLocalStore, useForceUpdate } from 'mobx-react-lite';\nimport { doWindowResize } from './utils';\nimport { toJS, set, remove } from 'mobx';\nimport 'react-grid-layout/css/styles.css';\nimport 'react-resizable/css/styles.css';\nimport { Size } from 'react-split-pane';\nimport shortid from 'shortid';\nimport { ItemSettingProps } from './ItemSettingForm';\nimport { FormComponentProps, ValidationRule } from 'antd/lib/form';\nimport { RadioChangeEvent } from 'antd/lib/radio';\nimport { ApolloClient } from 'apollo-boost';\nimport debounce from 'lodash/debounce';\nconst emptyLayouts: BreakpointsLayouts = {\n  xxl: [],\n  xl: [],\n  lg: [],\n  md: [],\n  sm: [],\n  xs: [],\n};\ninterface Breakpoints {\n  xxl?: number;\n  xl?: number;\n  lg?: number;\n  md?: number;\n  sm?: number;\n  xs?: number;\n}\ntype ColNumber = 1 | 2 | 3 | 4 | 6 | 8 | 12 | 24;\ninterface Cols {\n  xxl?: ColNumber;\n  xl?: ColNumber;\n  lg?: ColNumber;\n  md?: ColNumber;\n  sm?: ColNumber;\n  xs?: ColNumber;\n}\n/**\n * RGL的基础配置\n */\nexport interface RGLConfig {\n  draggableCancel: string;\n  /**\n   * 元素单位高度\n   */\n  rowHeight?: number;\n  /**\n   * 元素间距\n   */\n  margin?: [number, number];\n  /**\n   *元素的断点布局\n   */\n  layouts: BreakpointsLayouts;\n  /**\n   * 响应断点宽度\n   */\n  breakpoints: Breakpoints;\n  /**\n   * 断点对应格子数\n   */\n  cols: Cols;\n}\n\n/**\n * RGL元素\n */\nexport interface RGLItem {\n  /**\n   * A string corresponding to the component key\n   */\n  i: string;\n  /**\n   * These are all in grid units, not pixels\n   */\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n  minW?: number;\n  maxW?: number;\n  minH?: number;\n  maxH?: number;\n  // If true equal to `isDraggable: false, isResizable: false`.\n  static?: boolean;\n  moved?: boolean;\n  // If false, will not be draggable. Overrides `static`.\n  isDraggable?: boolean;\n  // If false, will not be resizable. Overrides `static`.\n  isResizable?: boolean;\n}\n\n/**\n * 断点布局\n */\nexport interface BreakpointsLayouts {\n  xxl?: RGLItem[];\n  xl?: RGLItem[];\n  lg?: RGLItem[];\n  md?: RGLItem[];\n  sm?: RGLItem[];\n  xs?: RGLItem[];\n}\n\n/**\n * 组件基础属性\n */\ninterface BaseComponentProp {\n  /**\n   * 属性名称\n   */\n  label: string;\n  /**\n   * 类型\n   */\n  type:\n    | 'array:component'\n    | 'array:string'\n    | 'string'\n    | 'number'\n    | 'FPR'\n    | 'graphql';\n  /**\n   * 校验规则\n   */\n  rules?: ValidationRule[];\n  /**\n   * 组件\n   */\n  Component?: React.ComponentClass | ExoticComponent | null | React.SFC;\n  /**\n   * type为array时是否默认增加一个元素\n   */\n  shouldHaveOne?: boolean;\n  /**\n   * 存在组件的话可设置组件默认属性\n   */\n  componentProps?: ComponentProps;\n}\nexport interface CommonComponentProp {\n  /**\n   * id,用于平铺组件查找,仅仅带有component类型的组件有\n   */\n  id: string;\n}\n/**\n * 数组组件属性\n */\nexport interface ArrayComponentProp\n  extends BaseComponentProp,\n    CommonComponentProp {\n  /**\n   * 类型\n   */\n  type: 'array:component';\n  /**\n   * 组件\n   */\n  Component: React.ComponentClass | ExoticComponent | React.SFC;\n  /**\n   * type为array时是否默认增加一个元素\n   */\n  shouldHaveOne?: boolean;\n  /**\n   * 存在组件的话可设置组件默认属性\n   */\n  componentProps?: ComponentProps;\n}\n/**\n * 数组字符串\n */\nexport interface ArrayStringProp extends BaseComponentProp {\n  /**\n   * 类型\n   */\n  type: 'array:string';\n  /**\n   * type为array时是否默认增加一个元素\n   */\n  shouldHaveOne?: boolean;\n}\n\nexport interface FPRProp extends BaseComponentProp {\n  type: 'FPR';\n}\n\nexport interface StringProp extends BaseComponentProp {\n  /**\n   * 类型\n   */\n  type: 'string';\n}\nexport interface GraphqlProp extends BaseComponentProp {\n  /**\n   * 类型\n   */\n  type: 'graphql';\n}\nexport type ComponentPropsCommon =\n  | FPRProp\n  | ArrayComponentProp\n  | ArrayStringProp\n  | StringProp\n  | GraphqlProp;\n\nexport type ComponentPropsChildren =\n  | FPRProp\n  | ArrayComponentProp\n  | ArrayStringProp\n  | StringProp;\n\nexport interface ComponentProps {\n  [propName: string]: ComponentPropsCommon;\n\n  children?: ComponentPropsChildren;\n}\n\n/**\n * 组件基础\n */\nexport interface BaseComponentType {\n  /**\n   * 主键\n   */\n  id: string;\n  /**\n   * 组件名称\n   */\n  label: string;\n  /**\n   * 组件引入名称\n   */\n  name: string;\n  asName?: string;\n  /**\n   * 子组件\n   */\n  children?: Omit<BaseComponentType, 'children'>[];\n  /**\n   * 父组件\n   */\n  parent?: BaseComponentType;\n  /**\n   * 组件,本想dynamic import 一下，但是webpack不支持\n   */\n  Component: React.ComponentClass | React.SFC;\n  /**\n   * 组件属性\n   */\n  componentProps?: ComponentProps;\n  /**\n   * 是否可为表单域\n   */\n  formField?: boolean;\n}\n\n/**\n * 组件类型\n */\nexport interface ComponentType extends BaseComponentType {\n  /**\n   * 引入路径\n   */\n  path: string;\n  /**\n   * 是否为默认引入\n   */\n  isDefault: boolean;\n  /**\n   * 分组\n   */\n  group?: string;\n}\n\nexport interface ComponentGroup {\n  [groupName: string]: ComponentType[] | string;\n}\n\nexport interface FPBProps extends FormComponentProps {\n  /**\n   * 断点差值\n   */\n  breakpointDiff?: number;\n  /**\n   * 外层自定义布局\n   * @param showPart 主要显示内容\n   */\n  layout?(showPart: React.ReactElement): React.ReactElement;\n  FPR?: boolean;\n  forwardRef?: any;\n  /**\n   * 延迟渲染，在模态框弹出动画非常有用，antd modal设置200即可\n   */\n  renderDelay?: number;\n  /**\n   * 渲染其他操作\n   */\n  renderActions?(): React.ReactElement;\n  defaultDatas?: FPBConfig;\n  /**\n   * 左侧布局的默认宽度\n   */\n  contentDefaultSize?: Size;\n  /**\n   * 导入组件\n   */\n  components: ComponentType[];\n  /**\n   * 父级断点，存在时可以锁死断点?很奇怪的是局部宽度响应了fpr\n   */\n  breakpoint?: Breakpoint;\n}\nexport interface ApolloFPBProps extends FPBProps {\n  client: ApolloClient<any>;\n}\nexport interface BreakpointsConfig {\n  breakpoints: string[];\n  cols: Cols;\n}\n\nexport interface FPBConfig {\n  /**\n   *元素的断点布局\n   */\n  layouts: BreakpointsLayouts;\n  /**\n   * 数据源\n   */\n  datas: FPBItemIndexListInitial;\n  /**\n   * 断点对应格子数\n   */\n  cols?: Cols;\n  /**\n   * 包含断点\n   */\n  breakpoints?: string[];\n}\nexport type Breakpoint = 'xxl' | 'xl' | 'lg' | 'md' | 'sm' | 'xs';\n/**\n * pb的store\n */\nexport interface FPBStore extends RGLConfig, ItemSettingProps {\n  /**\n   * 不让拖拽的样式名称\n   */\n  draggableCancelClassName: string;\n  /**\n   * 编辑元素窗口的标题，取i\n   */\n  editingTitle: string;\n  setBreakpointFromEntry(breakpoints: any, breakpointDiff?: number);\n  /**\n   * 获取全部配置项以及数据\n   */\n  config: FPBConfig;\n  /**\n   * 删除区块\n   * @param itemKey 主键\n   */\n  deleteItem(itemKey: string): void;\n  /**\n   * 模式\n   * @enum Mode\n   */\n  mode: Mode;\n  changeMode: (e: RadioChangeEvent) => void;\n  /**\n   * 模式\n   */\n  isPreview: boolean;\n  isDesign: boolean;\n  /**\n   * 索引数据源\n   */\n  datas: FPBItemIndexList;\n  hasLayout: () => boolean;\n  breakpoint: Breakpoint;\n  /**\n   * 断点数组的key\n   */\n  breakpointsArr: string[];\n  /**\n   * 获取当前所有断点的布局数组\n   */\n  computedLayout: BreakpointsLayouts;\n  /**\n   *断点计算配置用于表单初始值\n   */\n  breakpointsConfig: BreakpointsConfig;\n  /**\n   * 布局变更\n   * @param currentLayout 当前布局\n   * @param layouts 变更后布局\n   */\n  setLayouts(currentLayout: BreakpointsLayouts, layouts: BreakpointsLayouts);\n  /**\n   * 数据集合变更\n   *\n   * @param datas 数据集合\n   */\n  setDatas(datas);\n  /**\n   * 设置当前断点\n   * @param breakpoint 当前断点\n   * @param col 布局列\n   */\n  setBreakpoint(breakpoint, col?);\n  /**\n   * RGLConfig\n   */\n  jsConfig: RGLConfig;\n  /**\n   * 根据高度计算元素相对的h\n   * @param height 高度\n   * @param key 主键\n   */\n  caclHeight(height: number | null | undefined, key: string);\n  /**\n   * 创建一个元素\n   */\n  createItem();\n  /**\n   * 根据主键查询当前断点下的item\n   * @param key 主键\n   */\n  findItem(key: string): RGLItem;\n  /**\n   * 找出全部断点下的当前item\n   */\n  findItemInAllBreakpoints(key: string): { [point: string]: RGLItem };\n  /**\n   * 获取元素当前响应布局高度高度\n   * @param key 主键\n   */\n  getItemHeight(key): number;\n  /**\n   * item的resize事件\n   */\n  onResize: RGLItemCallBack;\n  onResizeStop: RGLItemCallBack;\n  /**\n   * 操作中的item\n   */\n  operatedItem: RGLItem;\n  /**\n   * 设置操作中数据\n   * @param item @interface RGLItem\n   */\n  setOperatedItem(item: RGLItem);\n  /**\n   * 编辑中的数据\n   */\n  editingItem: FPBItem;\n  /**\n   * 设置编辑中的数据\n   * @param item @interface FPBItem\n   */\n  setEditingItem(item: FPBItem);\n  /**\n   * 编辑状态\n   */\n  isEditing: boolean;\n  /**\n   * 平铺组件，方便查找\n   */\n  flatComponents: { [id: string]: ComponentType };\n  /**\n   * 组件的为formField,则编辑时默认表单域为true\n   */\n  defaultFormField: boolean;\n  /**\n   * 断点设置弹出\n   */\n  breakpointSettingVisible: boolean;\n  setBreakpointSettingVisible(breakpointSettingVisible: boolean);\n  /**\n   * 设置布局断点配置\n   */\n  setBreakpointConfig(values,setBreakpointConfig?:number);\n}\nexport type RGLItemCallBack = (\n  layout: RGLItem[],\n  /**\n   * 旧数据\n   */\n  oldItem: RGLItem,\n  /**\n   * 新数据\n   */\n  newItem: RGLItem,\n  placeholder: RGLItem,\n  e: MouseEvent,\n  element: HTMLElement,\n) => void;\nexport interface FPBItemIndexList {\n  [key: string]: FPBItem;\n}\nexport interface FPBItemIndexListInitial {\n  [key: string]: Omit<FPBItem, 'Component'>;\n}\n\nexport enum Mode {\n  /**\n   * 设计模式\n   */\n  DESIGN = 'design',\n  /**\n   * 预览模式\n   */\n  PRIVIEW = 'priview',\n}\n\n/**\n * fpb元素\n */\nexport interface FPBItem {\n  /**\n   * 主键\n   */\n  i: string;\n  /**\n   * 组件类\n   */\n  Component: React.ComponentClass | React.SFC;\n  /**\n   * 组件属性\n   */\n  componentProps: { [key: string]: any };\n  /**\n   * 自适应高度\n   */\n  autoHeight: boolean;\n  /**\n   * 组件id\n   */\n  componentId: string;\n  /**\n   * 是否为表单域\n   */\n  isFormField: boolean;\n  /**\n   * 表单域id,默认为i\n   */\n  $id: string;\n  /**\n   * 表单域的label\n   */\n  label?: string;\n}\n// xs\t<576px 响应式栅格，可为栅格数或一个包含其他属性的对象\tnumber|object\t-\n// sm\t≥576px 响应式栅格，可为栅格数或一个包含其他属性的对象\tnumber|object\t-\n// md\t≥768px 响应式栅格，可为栅格数或一个包含其他属性的对象\tnumber|object\t-\n// lg\t≥992px 响应式栅格，可为栅格数或一个包含其他属性的对象\tnumber|object\t-\n// xl\t≥1200px 响应式栅格，可为栅格数或一个包含其他属性的对象\tnumber|object\t-\n// xxl\nexport const breakpointsStandard: Breakpoints = {\n  xl: 1600,\n  lg: 1200,\n  md: 992,\n  sm: 768,\n  xs: 576,\n  // xs: 0\n};\nconst defaultbreakpoints: Breakpoints = {\n  lg: breakpointsStandard.lg,\n  // md: breakpointsStandard.md\n};\nconst defaultCols: Cols = { xxl: 12, xl: 12, lg: 8, md: 6, sm: 4, xs: 2 };\n\nconst useFPBStore = (props): FPBStore => {\n  const force = useForceUpdate();\n  const store: FPBStore = useLocalStore<\n    FPBStore,\n    Omit<Omit<FPBProps, 'form'>, 'apolloClient'>\n  >(\n    source => ({\n      rowHeight: 1,\n      margin: [0, 0],\n      layouts: emptyLayouts,\n      breakpoints: defaultbreakpoints,\n      cols: defaultCols,\n      get draggableCancelClassName() {\n        return shortid.generate();\n      },\n      get draggableCancel() {\n        return store.editingItem !== null || store.isPreview\n          ? `.${store.draggableCancelClassName}`\n          : '';\n      },\n      /*********************** */\n      get editingTitle() {\n        return store.editingItem && store.editingItem.i;\n      },\n      get config() {\n        return toJS<FPBConfig>(\n          {\n            datas: store.datas,\n            layouts: store.layouts,\n            cols: store.cols,\n            breakpoints: store.breakpointsArr,\n          },\n          { recurseEverything: true },\n        );\n      },\n      mode: Mode.DESIGN,\n      get isDesign() {\n        return store.mode === Mode.DESIGN;\n      },\n      get isPreview() {\n        return store.mode === Mode.PRIVIEW;\n      },\n      changeMode(e) {\n        store.mode = e.target.value;\n      },\n      datas: {},\n      breakpoint: 'lg',\n      defaultFormField: true,\n      get breakpointsConfig() {\n        return {\n          breakpoints: store.breakpointsArr,\n          cols: store.cols,\n        };\n      },\n      get breakpointsArr() {\n        return Object.keys(store.breakpoints);\n      },\n      get computedLayout() {\n        return Object.fromEntries(\n          store.breakpointsArr.map(point => [\n            point,\n            store.layouts[point] || [],\n          ]),\n        );\n      },\n      hasLayout() {\n        return Object.keys(store.datas).length !== 0;\n      },\n      setDatas(datas: any) {\n        const entries = Object.fromEntries(\n          Object.entries(datas).map(([key, data]: [string, any]) => [\n            key,\n            {\n              ...data,\n              Component:\n                data.componentId &&\n                store.flatComponents[data.componentId].Component,\n            },\n          ]),\n        ) as any;\n        store.datas = entries;\n      },\n      setLayouts(_currentLayout, layouts) {\n        if (JSON.stringify(store.layouts) == JSON.stringify(layouts)) {\n          return;\n        }\n        console.log('layout-change', toJS(store.layouts), layouts);\n        store.layouts = layouts;\n      },\n      setBreakpoint(breakpoint, _col) {\n        console.log('setBreakpoint', breakpoint, store.datas);\n\n        store.breakpoint = source.breakpoint || breakpoint;\n      },\n      setBreakpointFromEntry(breakpoints, breakpointDiff = 0) {\n        store.breakpoints = Object.fromEntries(\n          breakpoints.map(point => [\n            point,\n            breakpointsStandard[point] + breakpointDiff,\n          ]),\n        );\n      },\n      setBreakpointConfig(values,setBreakpointConfig=0) {\n        store.setBreakpointFromEntry(values.breakpoints,setBreakpointConfig);\n        store.cols = {\n          ...store.cols,\n          ...values.cols,\n        };\n        store.setBreakpointSettingVisible(false);\n      },\n      deleteItem(key) {\n        remove(store.datas, key);\n        force();\n        // setTimeout(doWindowResize,300)\n      },\n      get jsConfig() {\n        return toJS(\n          {\n            layouts: store.computedLayout,\n            rowHeight: store.rowHeight,\n            margin: store.margin,\n            breakpoints: store.breakpoints,\n            cols: store.cols,\n            onBreakpointChange: store.setBreakpoint,\n            onLayoutChange: store.setLayouts,\n            onResize: store.onResize,\n            onResizeStop: store.onResizeStop,\n            draggableCancel: store.draggableCancel,\n            //此处是个问题\n            // isDraggable: store.editingItem === null && !store.isPreview,\n            // isResizable: store.editingItem === null && !store.isPreview,\n          },\n          { recurseEverything: true },\n        );\n      },\n\n      operatedItem: null,\n      setOperatedItem(operatedItem) {\n        store.operatedItem = operatedItem;\n      },\n      onResize(_layout, _oldItem, newItem) {\n        store.setOperatedItem(newItem);\n      },\n      onResizeStop() {\n        store.setOperatedItem(null);\n      },\n      findItem(key) {\n        return store.layouts[store.breakpoint].find(b => b.i === key);\n      },\n      findItemInAllBreakpoints(key) {\n        return Object.fromEntries(\n          Object.entries(store.layouts).map(([point, items]) => [\n            point,\n            items.find((item: { i: string }) => item.i === key),\n          ]),\n        );\n      },\n      getItemHeight(key) {\n        const item = store.findItem(key);\n        return item && item.h;\n      },\n      caclHeight(height, key) {\n        const itemData = store.datas[key];\n        const item = store.findItem(key);\n        const breakpointsItems = store.findItemInAllBreakpoints(key);\n        if (!itemData.autoHeight) {\n          Object.values(breakpointsItems).forEach(item => {\n            if (item) {\n              delete item.maxH;\n              delete item.minH;\n            }\n          });\n\n          return;\n        }\n        if (height === null || height === undefined) {\n          return;\n        }\n        //store中对应的数据，非布局\n        const h = Math.ceil(height / store.rowHeight);\n        item.h = h || 30;\n        item.maxH = item.h;\n        item.minH = item.h;\n        // debounce(doWindowResize,200)\n        // console.log(store.layouts);\n\n        // store.setLayouts([] as any, store.layouts);\n      },\n      createItem() {\n        const i = shortid.generate();\n        // store.layouts[store.breakpoint].push(item);\n        const newItem: FPBItem = {\n          i,\n          Component: null,\n          autoHeight: true,\n          componentProps: {},\n          componentId: null,\n          isFormField: null,\n          $id: null,\n        };\n        set(store.datas, i, newItem);\n        force();\n        // setTimeout(doWindowResize, 200);\n      },\n      editingItem: null,\n      onItemTypeChange(value) {\n        if (!value) {\n          store.editingItem.Component = null;\n          store.editingItem.componentProps = null;\n          store.editingItem.isFormField = null;\n          delete store.editingItem.label;\n          return;\n        }\n        const component = store.flatComponents[value];\n\n        store.editingItem.Component = component.Component;\n        store.editingItem.componentProps = {};\n        if (component.formField) {\n          store.editingItem.isFormField = store.defaultFormField;\n          // store.editingItem.label = \"\";\n          set(store.editingItem, 'label', '');\n          // .label = '';\n          //这里默认给i值吧\n          // store.editingItem.$id = shortid.generate()\n        }\n\n        // Object.entries(component.componentProps).\n        // store.editingItem.componentProps = ;\n        store.editingItem.componentId = value;\n\n        // set(store.editingItem, field, value);\n      },\n      onItemPropsChange(field, value) {\n        store.editingItem[field] = value;\n      },\n      get isEditing() {\n        return store.editingItem !== null;\n      },\n      setEditingItem(editingItem) {\n        store.editingItem = editingItem;\n      },\n      get flatComponents() {\n        const flatComponents = {};\n        const dealChildren = (\n          arr: (ComponentType | BaseComponentType)[] = source.components,\n          parent?: ComponentType | BaseComponentType,\n        ) => {\n          arr.forEach(component => {\n            flatComponents[component.id] = component;\n            if (parent) {\n              component.parent = parent;\n            }\n            if (component.children) {\n              dealChildren(component.children, component);\n            }\n          });\n        };\n        dealChildren();\n        return flatComponents;\n      },\n      get componentGroup() {\n        //有分组组件\n        const componentsHasGroup = source.components.filter(\n          component => component.group,\n        );\n        //无分组组件\n        const componentsNoGroup = source.components.filter(\n          component => !component.group,\n        );\n        //全部分组\n        const allGroup = [\n          ...new Set(componentsHasGroup.map(component => component.group)),\n        ];\n        //自动分组\n        const returnGroup = [];\n        allGroup.forEach(group => {\n          const filterGroup = componentsHasGroup.filter(\n            component => component.group === group,\n          );\n          returnGroup.push({ [group]: filterGroup, groupName: group });\n        });\n        componentsNoGroup.forEach(component => {\n          returnGroup.push(component);\n        });\n        return returnGroup;\n      },\n      breakpointSettingVisible: false,\n      setBreakpointSettingVisible(breakpointSettingVisible) {\n        store.breakpointSettingVisible = breakpointSettingVisible;\n      },\n    }),\n    { components: props.components, breakpoint: props.breakpoint },\n  );\n  return store;\n};\n\nexport default useFPBStore;\n"],"mappings":"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"}