{"version":3,"file":"FPBForm.js","names":["create","Item","FPBForm","props","ref","useRef","footerRef","store","useLocalStore","visible","destory","setVisible","setTimeout","minuHeight","current","clientHeight","_","height","transform","padding","onChange","config","components","value"],"sources":["../src/fpb/FPBForm.tsx"],"sourcesContent":["import React, { SFC, useRef, useEffect } from 'react';\nimport { Form, Button, Modal, Drawer } from 'antd';\nimport FullScreenModal from './FullScreenModal';\nimport FPB from './FPB';\nimport { ComponentType } from './useFPBStore';\nimport { FormComponentProps } from 'antd/lib/form';\nimport { useLocalStore, Observer } from 'mobx-react-lite';\nimport { doWindowResize } from './utils';\nconst { create, Item } = Form;\ninterface FPBFormProps {\n  components: ComponentType[];\n  onChange?(e);\n  value?;\n}\nconst FPBForm: SFC<FPBFormProps> = props => {\n  const ref: any = useRef();\n  const footerRef: any = useRef();\n  const store = useLocalStore(() => ({\n    visible: false,\n    destory: false,\n    setVisible(visible) {\n      store.visible = visible;\n      if (visible) {\n        setTimeout(() => {\n          store.minuHeight = footerRef.current.clientHeight + 21;\n        }, 0);\n      }\n    },\n    minuHeight: 0,\n  }));\n  return (\n    <>\n      <Button onClick={_ => store.setVisible(true)}>设计</Button>\n      <Observer>\n        {() => (\n          <Drawer\n            drawerStyle={{ height: `100%` }}\n            style={{ height: `100%`, transform: `translate(0)` }}\n            bodyStyle={{ height: `100%`, padding: 5 }}\n            width={`100%`}\n            onClose={_ => store.setVisible(false)}\n            destroyOnClose\n            visible={store.visible}\n          >\n            <>\n              <style>\n                {`\n            .react-grid-item > .react-resizable-handle{\n              display:block;\n            }\n            `}\n              </style>\n              <FPB\n                renderActions={() => (\n                  <>\n                    <Item>\n                      <Button\n                        type=\"primary\"\n                        onClick={_ => {\n                          //   ref.current.config;\n                          props.onChange(null);\n                          setTimeout(\n                            () => props.onChange(ref.current.config),\n                            200,\n                          );\n                        }}\n                      >\n                        保存\n                      </Button>\n                    </Item>\n                    <Item>\n                      <Button\n                        type=\"danger\"\n                        onClick={_ => {\n                          //   ref.current.config;\n                          if (props.onChange) {\n                            props.onChange(null);\n                            setTimeout(\n                              () => props.onChange(ref.current.config),\n                              200,\n                            );\n                          }\n                          store.setVisible(false);\n                        }}\n                      >\n                        保存并关闭\n                      </Button>\n                    </Item>\n                  </>\n                )}\n                renderDelay={200}\n                forwardRef={ref}\n                components={props.components}\n                defaultDatas={props.value}\n              />\n            </>\n          </Drawer>\n        )}\n      </Observer>\n    </>\n  );\n};\n\nexport default FPBForm;\n"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AAGA;AAA0D;AAAA;AAAA;AAE1D,IAAQA,MAAM,iBAANA,MAAM;EAAEC,IAAI,iBAAJA,IAAI;AAMpB,IAAMC,OAA0B,GAAG,SAA7BA,OAA0B,CAAGC,KAAK,EAAI;EAC1C,IAAMC,GAAQ,GAAG,IAAAC,aAAM,GAAE;EACzB,IAAMC,SAAc,GAAG,IAAAD,aAAM,GAAE;EAC/B,IAAME,KAAK,GAAG,IAAAC,4BAAa,EAAC;IAAA,OAAO;MACjCC,OAAO,EAAE,KAAK;MACdC,OAAO,EAAE,KAAK;MACdC,UAAU,sBAACF,OAAO,EAAE;QAClBF,KAAK,CAACE,OAAO,GAAGA,OAAO;QACvB,IAAIA,OAAO,EAAE;UACXG,UAAU,CAAC,YAAM;YACfL,KAAK,CAACM,UAAU,GAAGP,SAAS,CAACQ,OAAO,CAACC,YAAY,GAAG,EAAE;UACxD,CAAC,EAAE,CAAC,CAAC;QACP;MACF,CAAC;MACDF,UAAU,EAAE;IACd,CAAC;EAAA,CAAC,CAAC;EACH,oBACE,yEACE;IAAQ,OAAO,EAAE,iBAAAG,CAAC;MAAA,OAAIT,KAAK,CAACI,UAAU,CAAC,IAAI,CAAC;IAAA;EAAC,kBAAY,eACzD,6BAAC,uBAAQ,QACN;IAAA,oBACC;MACE,WAAW,EAAE;QAAEM,MAAM;MAAS,CAAE;MAChC,KAAK,EAAE;QAAEA,MAAM,QAAQ;QAAEC,SAAS;MAAiB,CAAE;MACrD,SAAS,EAAE;QAAED,MAAM,QAAQ;QAAEE,OAAO,EAAE;MAAE,CAAE;MAC1C,KAAK,QAAS;MACd,OAAO,EAAE,iBAAAH,CAAC;QAAA,OAAIT,KAAK,CAACI,UAAU,CAAC,KAAK,CAAC;MAAA,CAAC;MACtC,cAAc;MACd,OAAO,EAAEJ,KAAK,CAACE;IAAQ,gBAEvB,yEACE,mKAMQ,eACR,6BAAC,YAAG;MACF,aAAa,EAAE;QAAA,oBACb,yEACE,6BAAC,IAAI,qBACH;UACE,IAAI,EAAC,SAAS;UACd,OAAO,EAAE,iBAAAO,CAAC,EAAI;YACZ;YACAb,KAAK,CAACiB,QAAQ,CAAC,IAAI,CAAC;YACpBR,UAAU,CACR;cAAA,OAAMT,KAAK,CAACiB,QAAQ,CAAChB,GAAG,CAACU,OAAO,CAACO,MAAM,CAAC;YAAA,GACxC,GAAG,CACJ;UACH;QAAE,kBAGK,CACJ,eACP,6BAAC,IAAI,qBACH;UACE,IAAI,EAAC,QAAQ;UACb,OAAO,EAAE,iBAAAL,CAAC,EAAI;YACZ;YACA,IAAIb,KAAK,CAACiB,QAAQ,EAAE;cAClBjB,KAAK,CAACiB,QAAQ,CAAC,IAAI,CAAC;cACpBR,UAAU,CACR;gBAAA,OAAMT,KAAK,CAACiB,QAAQ,CAAChB,GAAG,CAACU,OAAO,CAACO,MAAM,CAAC;cAAA,GACxC,GAAG,CACJ;YACH;YACAd,KAAK,CAACI,UAAU,CAAC,KAAK,CAAC;UACzB;QAAE,oCAGK,CACJ,CACN;MAAA,CACH;MACF,WAAW,EAAE,GAAI;MACjB,UAAU,EAAEP,GAAI;MAChB,UAAU,EAAED,KAAK,CAACmB,UAAW;MAC7B,YAAY,EAAEnB,KAAK,CAACoB;IAAM,EAC1B,CACD,CACI;EAAA,CACV,CACQ,CACV;AAEP,CAAC;AAAC,eAEarB,OAAO;AAAA"}