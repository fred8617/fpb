{"version":3,"sources":["../src/FPB/FPBForm.tsx"],"names":["create","Item","FPBForm","props","ref","footerRef","store","visible","destory","setVisible","setTimeout","minuHeight","current","clientHeight","_","height","transform","padding","onChange","config","components","value"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;AAGA;;AAGA;;;;;;;;IAEQA,M,iBAAAA,M;IAAQC,I,iBAAAA,I;;AAMhB,IAAMC,OAA0B,GAAG,SAA7BA,OAA6B,CAAAC,KAAK,EAAI;AAC1C,MAAMC,GAAQ,GAAG,oBAAjB;AACA,MAAMC,SAAc,GAAG,oBAAvB;AACA,MAAMC,KAAK,GAAG,kCAAc;AAAA,WAAO;AACjCC,MAAAA,OAAO,EAAE,KADwB;AAEjCC,MAAAA,OAAO,EAAE,KAFwB;AAGjCC,MAAAA,UAHiC,sBAGtBF,OAHsB,EAGb;AAClBD,QAAAA,KAAK,CAACC,OAAN,GAAgBA,OAAhB;;AACA,YAAIA,OAAJ,EAAa;AACXG,UAAAA,UAAU,CAAC,YAAM;AACfJ,YAAAA,KAAK,CAACK,UAAN,GAAmBN,SAAS,CAACO,OAAV,CAAkBC,YAAlB,GAAiC,EAApD;AACD,WAFS,EAEP,CAFO,CAAV;AAGD;AACF,OAVgC;AAWjCF,MAAAA,UAAU,EAAE;AAXqB,KAAP;AAAA,GAAd,CAAd;AAaA,SACE,4DACE;AAAQ,IAAA,OAAO,EAAE,iBAAAG,CAAC;AAAA,aAAIR,KAAK,CAACG,UAAN,CAAiB,IAAjB,CAAJ;AAAA;AAAlB,oBADF,EAEE,6BAAC,uBAAD,QACG;AAAA,WACC;AACE,MAAA,WAAW,EAAE;AAAEM,QAAAA,MAAM;AAAR,OADf;AAEE,MAAA,KAAK,EAAE;AAAEA,QAAAA,MAAM,QAAR;AAAkBC,QAAAA,SAAS;AAA3B,OAFT;AAGE,MAAA,SAAS,EAAE;AAAED,QAAAA,MAAM,QAAR;AAAkBE,QAAAA,OAAO,EAAE;AAA3B,OAHb;AAIE,MAAA,KAAK,QAJP;AAKE,MAAA,OAAO,EAAE,iBAAAH,CAAC;AAAA,eAAIR,KAAK,CAACG,UAAN,CAAiB,KAAjB,CAAJ;AAAA,OALZ;AAME,MAAA,cAAc,MANhB;AAOE,MAAA,OAAO,EAAEH,KAAK,CAACC;AAPjB,OASE,4DACE,mKADF,EAQE,6BAAC,YAAD;AACE,MAAA,aAAa,EAAE;AAAA,eACb,4DACE,6BAAC,IAAD,QACE;AACE,UAAA,IAAI,EAAC,SADP;AAEE,UAAA,OAAO,EAAE,iBAAAO,CAAC,EAAI;AACZ;AACAX,YAAAA,KAAK,CAACe,QAAN,CAAe,IAAf;AACAR,YAAAA,UAAU,CACR;AAAA,qBAAMP,KAAK,CAACe,QAAN,CAAed,GAAG,CAACQ,OAAJ,CAAYO,MAA3B,CAAN;AAAA,aADQ,EAER,GAFQ,CAAV;AAID;AATH,0BADF,CADF,EAgBE,6BAAC,IAAD,QACE;AACE,UAAA,IAAI,EAAC,QADP;AAEE,UAAA,OAAO,EAAE,iBAAAL,CAAC,EAAI;AACZ;AACA,gBAAIX,KAAK,CAACe,QAAV,EAAoB;AAClBf,cAAAA,KAAK,CAACe,QAAN,CAAe,IAAf;AACAR,cAAAA,UAAU,CACR;AAAA,uBAAMP,KAAK,CAACe,QAAN,CAAed,GAAG,CAACQ,OAAJ,CAAYO,MAA3B,CAAN;AAAA,eADQ,EAER,GAFQ,CAAV;AAID;;AACDb,YAAAA,KAAK,CAACG,UAAN,CAAiB,KAAjB;AACD;AAZH,4CADF,CAhBF,CADa;AAAA,OADjB;AAsCE,MAAA,WAAW,EAAE,GAtCf;AAuCE,MAAA,UAAU,EAAEL,GAvCd;AAwCE,MAAA,UAAU,EAAED,KAAK,CAACiB,UAxCpB;AAyCE,MAAA,YAAY,EAAEjB,KAAK,CAACkB;AAzCtB,MARF,CATF,CADD;AAAA,GADH,CAFF,CADF;AAuED,CAvFD;;eAyFenB,O","sourcesContent":["import React, { SFC, useRef, useEffect } from 'react';\r\nimport { Form, Button, Modal, Drawer } from 'antd';\r\nimport FullScreenModal from './FullScreenModal';\r\nimport FPB from './FPB';\r\nimport { ComponentType } from './useFPBStore';\r\nimport { FormComponentProps } from 'antd/lib/form';\r\nimport { useLocalStore, Observer } from 'mobx-react-lite';\r\nimport { doWindowResize } from './utils';\r\nconst { create, Item } = Form;\r\ninterface FPBFormProps {\r\n  components: ComponentType[];\r\n  onChange?(e);\r\n  value?;\r\n}\r\nconst FPBForm: SFC<FPBFormProps> = props => {\r\n  const ref: any = useRef();\r\n  const footerRef: any = useRef();\r\n  const store = useLocalStore(() => ({\r\n    visible: false,\r\n    destory: false,\r\n    setVisible(visible) {\r\n      store.visible = visible;\r\n      if (visible) {\r\n        setTimeout(() => {\r\n          store.minuHeight = footerRef.current.clientHeight + 21;\r\n        }, 0);\r\n      }\r\n    },\r\n    minuHeight: 0,\r\n  }));\r\n  return (\r\n    <>\r\n      <Button onClick={_ => store.setVisible(true)}>设计</Button>\r\n      <Observer>\r\n        {() => (\r\n          <Drawer\r\n            drawerStyle={{ height: `100%` }}\r\n            style={{ height: `100%`, transform: `translate(0)` }}\r\n            bodyStyle={{ height: `100%`, padding: 5 }}\r\n            width={`100%`}\r\n            onClose={_ => store.setVisible(false)}\r\n            destroyOnClose\r\n            visible={store.visible}\r\n          >\r\n            <>\r\n              <style>\r\n                {`\r\n            .react-grid-item > .react-resizable-handle{\r\n              display:block;\r\n            }\r\n            `}\r\n              </style>\r\n              <FPB\r\n                renderActions={() => (\r\n                  <>\r\n                    <Item>\r\n                      <Button\r\n                        type=\"primary\"\r\n                        onClick={_ => {\r\n                          //   ref.current.config;\r\n                          props.onChange(null);\r\n                          setTimeout(\r\n                            () => props.onChange(ref.current.config),\r\n                            200,\r\n                          );\r\n                        }}\r\n                      >\r\n                        保存\r\n                      </Button>\r\n                    </Item>\r\n                    <Item>\r\n                      <Button\r\n                        type=\"danger\"\r\n                        onClick={_ => {\r\n                          //   ref.current.config;\r\n                          if (props.onChange) {\r\n                            props.onChange(null);\r\n                            setTimeout(\r\n                              () => props.onChange(ref.current.config),\r\n                              200,\r\n                            );\r\n                          }\r\n                          store.setVisible(false);\r\n                        }}\r\n                      >\r\n                        保存并关闭\r\n                      </Button>\r\n                    </Item>\r\n                  </>\r\n                )}\r\n                renderDelay={200}\r\n                forwardRef={ref}\r\n                components={props.components}\r\n                defaultDatas={props.value}\r\n              />\r\n            </>\r\n          </Drawer>\r\n        )}\r\n      </Observer>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default FPBForm;\r\n"],"file":"FPBForm.js"}